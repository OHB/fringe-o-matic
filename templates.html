<script type="text/ng-template" id="app/home/home.html">
<div class=container style=padding-top:8rem>
<div class=row>
<div class="col-md-4 col-md-offset-1 col-md-push-6 text-center">
<svg version=1.1 id=calendar-image xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink x=0px y=0px viewBox="0 0 409.601 409.601" style=max-width:50vw xml:space=preserve>
<path style=fill:#428bca d=M393.635,41.834H15.968c-8.818,0-15.966,7.07-15.966,15.791v54.073h409.599V57.625C409.601,48.904,402.453,41.834,393.635,41.834z />
<g>
<ellipse style=fill:#337ab7 cx=101.1 cy=75.449 rx=14.029 ry=13.875 />
<ellipse style=fill:#337ab7 cx=60.601 cy=75.449 rx=14.029 ry=13.875 />
</g>
<g>
<path style=fill:#64798A d=M60.601,0c-6.328,0-11.459,5.073-11.459,11.333v61.001c0,6.259,5.13,11.333,11.459,11.333s11.46-5.074,11.46-11.333V11.333C72.06,5.074,66.929,0,60.601,0z />
<path style=fill:#64798A d=M101.098,0C94.77,0,89.64,5.074,89.64,11.333v61.001c0,6.259,5.13,11.333,11.458,11.333c6.329,0,11.459-5.074,11.459-11.333V11.333C112.557,5.074,107.427,0,101.098,0z />
</g>
<g>
<ellipse style=fill:#337ab7 cx=348.98 cy=75.449 rx=14.029 ry=13.875 />
<ellipse style=fill:#337ab7 cx=308.48 cy=75.449 rx=14.029 ry=13.875 />
</g>
<g>
<path style=fill:#64798A d=M308.502,0c-6.327,0-11.458,5.073-11.458,11.333v61.001c0,6.259,5.131,11.333,11.458,11.333c6.329,0,11.46-5.074,11.46-11.333V11.333C319.963,5.074,314.831,0,308.502,0z />
<path style=fill:#64798A d=M349,0c-6.328,0-11.459,5.073-11.459,11.333v61.001c0,6.259,5.131,11.333,11.459,11.333c6.329,0,11.459-5.074,11.459-11.333V11.333C360.459,5.074,355.329,0,349,0z />
</g>
<rect x=0 y=111.698 style=fill:#E1E6E9 width=409.6 height=14.024 />
<path style=fill:#EBF0F3 d=M0,125.725v268.083c0,8.721,7.15,15.793,15.968,15.793h377.666c8.818,0,15.966-7.071,15.966-15.793V125.725H0z />
<path class=day style=fill:#D5D6DB d=M218.765,150.95h-27.927c-3.942,0-7.138,3.195-7.138,7.137v27.927c0,3.942,3.196,7.136,7.138,7.136h27.927c3.939,0,7.136-3.194,7.136-7.136v-27.927C225.9,154.145,222.704,150.95,218.765,150.95z />
<path class=day style=fill:#E56353 d=M292.628,150.95h-27.927c-3.942,0-7.138,3.195-7.138,7.137v27.927c0,3.942,3.196,7.136,7.138,7.136h27.927c3.94,0,7.136-3.194,7.136-7.136v-27.927C299.764,154.145,296.568,150.95,292.628,150.95z />
<path class=day style=fill:#44C4A1 d=M366.492,150.95h-27.927c-3.942,0-7.138,3.195-7.138,7.137v27.927c0,3.942,3.196,7.136,7.138,7.136h27.927c3.939,0,7.136-3.194,7.136-7.136v-27.927C373.627,154.145,370.431,150.95,366.492,150.95z />
<g>
<path class=day style=fill:#D5D6DB d=M71.038,214.692H43.111c-3.942,0-7.138,3.195-7.138,7.136v27.927c0,3.942,3.196,7.137,7.138,7.137h27.927c3.94,0,7.136-3.195,7.136-7.137v-27.927C78.174,217.887,74.978,214.692,71.038,214.692z />
<path class=day style=fill:#D5D6DB d=M144.901,214.692h-27.927c-3.942,0-7.138,3.195-7.138,7.136v27.927c0,3.942,3.196,7.137,7.138,7.137h27.927c3.94,0,7.136-3.195,7.136-7.137v-27.927C152.037,217.887,148.841,214.692,144.901,214.692z />
<path class=day style=fill:#D5D6DB d=M218.765,214.692h-27.927c-3.942,0-7.138,3.195-7.138,7.136v27.927c0,3.942,3.196,7.137,7.138,7.137h27.927c3.939,0,7.136-3.195,7.136-7.137v-27.927C225.9,217.887,222.704,214.692,218.765,214.692z />
</g>
<path class=day style=fill:#E56353 d=M292.628,214.692h-27.927c-3.942,0-7.138,3.195-7.138,7.136v27.927c0,3.942,3.196,7.137,7.138,7.137h27.927c3.94,0,7.136-3.195,7.136-7.137v-27.927C299.764,217.887,296.568,214.692,292.628,214.692z />
<path class=day style=fill:#44C4A1 d=M366.492,214.692h-27.927c-3.942,0-7.138,3.195-7.138,7.136v27.927c0,3.942,3.196,7.137,7.138,7.137h27.927c3.939,0,7.136-3.195,7.136-7.137v-27.927C373.627,217.887,370.431,214.692,366.492,214.692z />
<g>
<path class=day style=fill:#D5D6DB d=M71.038,278.433H43.111c-3.942,0-7.138,3.194-7.138,7.136v27.927c0,3.942,3.196,7.137,7.138,7.137h27.927c3.94,0,7.136-3.195,7.136-7.137V285.57C78.174,281.628,74.978,278.433,71.038,278.433z />
<path class=day style=fill:#D5D6DB d=M144.901,278.433h-27.927c-3.942,0-7.138,3.194-7.138,7.136v27.927c0,3.942,3.196,7.137,7.138,7.137h27.927c3.94,0,7.136-3.195,7.136-7.137V285.57C152.037,281.628,148.841,278.433,144.901,278.433z />
<path class=day style=fill:#D5D6DB d=M218.765,278.433h-27.927c-3.942,0-7.138,3.194-7.138,7.136v27.927c0,3.942,3.196,7.137,7.138,7.137h27.927c3.939,0,7.136-3.195,7.136-7.137V285.57C225.9,281.628,222.704,278.433,218.765,278.433z />
</g>
<path class=day style=fill:#E56353 d=M292.628,278.433h-27.927c-3.942,0-7.138,3.194-7.138,7.136v27.927c0,3.942,3.196,7.137,7.138,7.137h27.927c3.94,0,7.136-3.195,7.136-7.137V285.57C299.764,281.628,296.568,278.433,292.628,278.433z />
<path class=day style=fill:#44C4A1 d=M366.492,278.433h-27.927c-3.942,0-7.138,3.194-7.138,7.136v27.927c0,3.942,3.196,7.137,7.138,7.137h27.927c3.939,0,7.136-3.195,7.136-7.137V285.57C373.627,281.628,370.431,278.433,366.492,278.433z />
<g>
<path class=day style=fill:#D5D6DB d=M71.038,342.175H43.111c-3.942,0-7.138,3.194-7.138,7.136v27.927c0,3.942,3.196,7.137,7.138,7.137h27.927c3.94,0,7.136-3.195,7.136-7.137v-27.927C78.174,345.37,74.978,342.175,71.038,342.175z />
<path class=day style=fill:#D5D6DB d=M144.901,342.175h-27.927c-3.942,0-7.138,3.194-7.138,7.136v27.927c0,3.942,3.196,7.137,7.138,7.137h27.927c3.94,0,7.136-3.195,7.136-7.137v-27.927C152.037,345.37,148.841,342.175,144.901,342.175z />
</g>
</svg>
</div>
<div class="col-md-6 col-md-pull-5">
<h1 style=font-size:63px;font-weight:700;color:#428bca;margin-bottom:15px>Fringe-o-Matic</h1>
<p class=lead style=font-weight:500>Automatically create your perfect Fringe schedule.</p>
<p class=lead style=font-weight:400>Fringe-o-Matic is a free tool to help you get the most out of Fringe. Learn about shows, generate a schedule automatically based on your preferences and availability, and more.</p>
<p class=lead>Registration is not required.</p>
<br>
<p><a class="btn btn-primary btn-lg" href role=button ng-click=getStarted()>Get Started</a></p>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="app/test/test.html">
<div class=jumbotron>
<div class=container>
<h1>Test</h1>
</div>
</div>
<div class=container>
<h3>Current User Data</h3>
<pre class=well style=word-wrap:break-word;overflow-wrap:break-word;white-space:initial>{{userData}}</pre>
<h3>Set User Data</h3>
<p>
<button class="btn btn-primary" ng-repeat="(name, data) in testData" ng-click=import(data) style=margin-right:5px>{{name}}</button>
</p>
</div>
</script>
<script type="text/ng-template" id="app/venues/venues.html">
<div class=jumbotron style=margin-bottom:10px>
<div class=container>
<h1>Venues</h1>
</div>
</div>
<div class=container style=padding-top:20px>
<div class=row ng-if=venues>
<div class=col-md-3>
<div class="panel panel-primary" data-offset-top=-95 bs-affix>
<div class=panel-heading>
<h3 class=panel-title>Distance Calculator</h3>
</div>
<div class=panel-body>
<div class=form-group>
<label>From</label>
<select class=form-control ng-options="item as item.label for item in venueOptions" ng-model=distanceCalc.from></select>
</div>
<div class=form-group>
<label>To</label>
<select class=form-control ng-options="item as item.label for item in venueOptions" ng-model=distanceCalc.to></select>
</div>
<p>
<strong>Distance:</strong>
<span ng-show="distanceCalc.from==distanceCalc.to">No time at all!</span>
<span ng-show="distanceCalc.from!=distanceCalc.to && venues[distanceCalc.from.value].host==venues[distanceCalc.to.value].host">
These venues are at the same location...so a minute, maybe?
</span>
<span ng-show="venues[distanceCalc.from.value].host!=venues[distanceCalc.to.value].host">
{{distances[distanceCalc.from.value][distanceCalc.to.value] / 60}} minutes
</span>
</p>
<p ng-if="venues[distanceCalc.from.value].host!=venues[distanceCalc.to.value].host">
<strong>Drive or walk?</strong>
<span ng-show="distanceCalc.driving=='assumed'">Drive</span>
<span ng-show="distanceCalc.driving=='recommended'">Drive</span>
<span ng-show="distanceCalc.driving=='possible'">Either</span>
<span ng-show="distanceCalc.driving==''">Walk</span>
</p>
<p ng-show="distanceCalc.driving!=''">
<a class="btn btn-default btn-sm pull-right" style=margin-right:6px href="https://www.google.com/maps/dir/?api=1&origin={{venueHosts[venues[distanceCalc.from.value].host].name}}, {{venueHosts[venues[distanceCalc.from.value].host].address.join(', ')}}&destination={{venueHosts[venues[distanceCalc.to.value].host].name}}, {{venueHosts[venues[distanceCalc.to.value].host].address.join(', ')}}&travelmode={{(distanceCalc.driving=='possible') ? 'walking' : 'driving'}}" target=_blank>Get Directions</a>
</p>
</div>
</div>
</div>
<div class=col-md-9>
<div class=row ng-repeat="(hostId, host) in venueHosts">
<hr ng-if="! $first">
<div class=col-md-8>
<a class="btn btn-default btn-sm pull-right" style="margin:0 6px 0 10px" href="https://www.google.com/maps/dir/?api=1&destination={{host.name}}, {{host.address.join(', ')}}" target=_blank>Directions</a>
<h3 style=margin-top:0>{{host.name}}</h3>
<p>{{host.address.join(', ')}}</p>
<table class="table table-condensed">
<tr ng-repeat="venueId in ::getHostVenues(hostId)" ng-init="venue=venues[venueId]">
<td style=padding-top:9px ng-style="{borderBottom: $last ? '1px solid #ddd' : 0, borderTop: $first ? 0 : '1px solid #ddd'}">
<span class="label label-venue-default label-venue-{{venueId}}" style=font-size:.9em>{{venue.name}}</span>
</td>
<td class=text-right style=vertical-align:middle ng-style="{borderBottom: $last ? '1px solid #ddd' : 0, borderTop: $first ? 0 : '1px solid #ddd'}">
<a class="btn btn-default btn-sm" ng-href=/shows/venue/{{venue.slug}}>Shows</a>
<a class="btn btn-default btn-sm" ng-href=/map/venue/{{venue.slug}}>Map</a>
</td>
</tr>
</table>
</div>
<div class=col-md-4>
<a href=/map/host/{{host.slug}}>
<static-map size="'336x252'" markers="host.mapPos && host.mapPos.join() || host.address.join(', ')" style=width:100%></static-map>
</a>
</div>
</div>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="app/show/show.html">
<div class=container ng-if="! loaded">
<p class="text-center lead" style=margin-top:100px>Loading...</p>
</div>
<div class=container ng-if=loaded>
<div class=row style="margin:30px 0;color:#fff" ng-style="{backgroundColor: backgroundColor, color: textColor}">
<div class=col-md-7 style=padding-left:20px>
<div class=h3 style=line-height:1em ng-if=$parent.$parent.signedIn ng-style="{color: titleColor}">
<interest show-id=showId></interest>
</div>
<h1>{{show.name}}</h1>
<p ng-if=::show.artist>
<strong ng-bind=show.artist></strong><span ng-if=show.artistLocation>, {{show.artistLocation}}</span>
</p>
<hr>
<p>{{venues[show.venue].name}}</p>
<br>
<br>
<p>
<a href="https://orlandofringe.showare.com/eventperformances.asp?evt={{show.storeId}}" target=fringeshop class="btn btn-lg btn-default" ng-if=show.storeId>Buy Tickets</a>
</p>
</div>
<div class=col-md-5 style="height:450px;background:url(img/show/{{show.image}}) center no-repeat;background-size:cover" ng-style="{boxShadow: 'inset 20px 0 20px -6px ' + backgroundColor}"></div>
</div>
<div class=row>
<div class="col-md-8 lead">
<div style=margin-top:10px ng-bind-html=trustAsHtml(show.description)></div>
<p ng-if=show.warnings><br><em class=small>Note: {{show.warnings.join(', ')}}</em></p>
</div>
<div class="col-md-3 col-md-offset-1">
<h3 style=margin-top:10px>Notes</h3>
<p>
<strong>Length:</strong> {{(firstPerformance.stop - firstPerformance.start) / 60}} minutes<br>
<strong>Rating:</strong> {{ratings[show.rating]}}<br>
<strong>Tickets:</strong> {{show.price | price}}
</p>
<h3>Show Times</h3>
<ul class=list-unstyled>
<li ng-repeat="pId in show.performances" ng-class="{'text-muted': performances[pId].start < now}">
{{moment(performances[pId].start, 'X').format('MMM D, h:mma')}}
<i ng-if=isUserAttendingPerformance(pId) class="glyphicon glyphicon-check text-success" style=margin-left:5px></i>
</li>
</ul>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="app/shows/shows.html">
<div class=jumbotron>
<div class=container>
<h1>Shows</h1>
</div>
</div>
<div class=container>
<div class=row>
<div class=col-md-3>
<div data-offset-top=-95 bs-affix>
<div class="form-group has-feedback">
<label>Filter by keyword</label>
<input class=form-control placeholder=Search ng-model=search ng-change=searchTextEntered()>
<span class="glyphicon glyphicon-remove form-control-feedback pointer text-muted" ng-show=search.length ng-click=clearSearch()></span>
</div>
<div class=form-group>
<label>Venue</label>
<select class=form-control ng-model=selectedVenue ng-options="o.value as o.label for o in venueOptions" ng-change=refresh()></select>
</div>
<hr>
<div class=checkbox ng-show=isFringeOngoing>
<label>
<input type=checkbox ng-change=refresh() ng-model=hideWithoutShowtimes>
Hide shows with no performances
</label>
</div>
<div class=checkbox ng-show=$parent.$parent.signedIn>
<label>
<input type=checkbox ng-change=refresh() ng-model=hideNotInterested>
Hide shows I'm not interested in
</label>
</div>
<div class=checkbox ng-show=$parent.$parent.signedIn>
<label>
<input type=checkbox ng-change=refresh() ng-model=hideNotAttending>
Hide shows I'm not attending
</label>
</div>
<div class=checkbox ng-show=$parent.$parent.signedIn>
<label>
<input type=checkbox ng-change=refresh() ng-model=hideCantAttend>
Hide shows I can't see
</label>
</div>
</div>
</div>
<div class=col-md-9>
<div class="row text-center" style="margin:100px 0" ng-if="! dataLoaded">
<p class="lead text-center">Loading...</p>
</div>
<div class="row text-center" style="margin:100px 0" ng-if="dataLoaded && !allShows.length">
<p class="lead text-center">No matching shows.</p>
<p><button class="btn btn-sm" ng-click=resetFilters();refresh()>Clear filters</button></p>
</div>
<div class=row ng-repeat="showId in allShows" ng-init="show=shows[showId]" style=background:#f9f9f9;margin-bottom:10px ng-show=dataLoaded>
<div class=col-md-9 style=padding:15px>
<div class="pull-right lead" style=line-height:1em ng-if=$parent.$parent.signedIn>
<interest show-id=showId></interest>
</div>
<div style=height:100px>
<p class=lead style=line-height:1em;margin-bottom:10px><a href=/show/{{::show.slug}}>{{::show.name}}</a></p>
<p class=small>
<em ng-if=::show.artist>
<strong ng-bind=::show.artist></strong><span ng-if=::show.artistLocation>, {{::show.artistLocation}}</span>
</em>&nbsp;
</p>
</div>
<p style=margin-bottom:35px>
<span><a href=/show/{{::show.slug}} class="btn btn-primary">Learn More</a></span>
<span ng-if=::show.storeId><a href="https://orlandofringe.showare.com/eventperformances.asp?evt={{show.storeId}}" target=fringeshop class="btn btn-info" style=margin-left:5px>Buy Tickets</a></span>
</p>
<p style=margin:0 ng-init="firstPerformance = performances[show.performances[0]]">
<span class="label label-venue-default label-venue-{{show.venue}}">{{venues[show.venue].name}}</span>
<span class="small text-muted" style=margin-left:10px>
<em>
<ng-pluralize count=performanceCounts[showId] when="plurals[isFringeOngoing ? 'performanceMore' : 'performance']"></ng-pluralize>
</em>
</span>
</p>
</div>
<div class=col-md-3 style="height:220px;background:url(img/show/{{show.image}}) top;background-size:cover"></div>
</div>
</div>
</div>
</div>

</script>
<script type="text/ng-template" id="app/schedule/schedule.html">
<div class=jumbotron>
<div class=container>
<h1>Schedule</h1>
</div>
</div>
<div class=container>
<div class=row ng-if=loaded>
<div class=col-md-3>
<div data-offset-top=-95 bs-affix style=padding-top:3px>
<div ng-if=signedIn>
<div class=btn-group ng-model=settings.scheduleMode bs-radio-group style=width:100%>
<label class="btn btn-default" style=width:50% ng-class="settings.scheduleMode=='full' && 'btn-primary'" bs-tooltip="{title: 'Shows full schedule.'}">
<input type=radio value=full> Full
</label>
<label class="btn btn-default" style=width:50% ng-class="settings.scheduleMode=='smart' && 'btn-primary'" bs-tooltip="{title: 'Hides performances you\'re not interested in, can\'t attend, or are seeing at a different time.'}">
<input type=radio value=smart> Smart
</label>
</div>
<br>
<br>
</div>
<month-day-picker days=days model=filter.currentDay></month-day-picker>
</div>
</div>
<div class=col-md-9>
<div>
<div class=page-header style=margin:0>
<h1 style="margin:0 0 20px">
{{moment(filter.currentDay, 'X').format('dddd, MMMM D')}}
<small ng-show=dataLoaded><ng-pluralize count=schedule.length when=plurals.show></ng-pluralize></small>
</h1>
</div>
</div>
<div class="row text-center" style="margin:100px 0" ng-if=!schedule.length>
<p class="lead text-center">No shows to display for this day.</p>
<p><button class="btn btn-sm" ng-click="settings.scheduleMode='full'">Switch to Full Schedule</button></p>
</div>
<div class="row text-center" style="margin:100px 0" ng-if=!dataLoaded>
<p class="lead text-center">Loading...</p>
</div>
<div inner-height=innerHeight ng-style="{minHeight: (innerHeight-368) + 'px'}">
<table class="table table-striped" ng-show="schedule.length && dataLoaded">
<thead>
<tr>
<th>Time</th>
<th>Show</th>
<th ng-if=signedIn>Interest</th>
<th ng-if=signedIn width=135>Going?</th>
</tr>
</thead>
<tbody>
<tr ng-repeat="entry in schedule">
<td nowrap>
{{::moment(entry.performance.start, 'X').format('h:mma')}} - {{::moment(entry.performance.stop, 'X').format('h:mma')}}
</td>
<td>
<p class=h4 style="margin:0 0 12px"><a href=/show/{{::entry.show.slug}}>{{::entry.show.name}}</a></p>
<p style=margin:0>
<span><a href=/show/{{::entry.show.slug}} class="btn btn-xs btn-primary">Learn More</a></span>
<span ng-if="! entry.inPast"><a href="https://orlandofringe.showare.com/orderticketsarea.asp?p={{entry.performance.storeId}}" target=fringeshop class="btn btn-xs btn-success" style=margin-left:10px>Buy Tickets</a></span>
</p>
</td>
<td nowrap class=align-middle ng-if=signedIn>
<interest show-id=entry.showId></interest>
</td>
<td nowrap class=align-middle ng-if="signedIn && entry.inPast">
<div class=btn-group bs-radio-group ng-model=entry.attendState>
<label class="btn disabled btn-default" ng-class="entry.attendState == 'no' && 'btn-danger'">
<input type=radio value=no disabled><span class="glyphicon glyphicon-thumbs-down"></span>
</label>
<label class="btn disabled btn-default" ng-class="entry.attendState == 'maybe' && 'btn-warning'">
<input type=radio value=maybe disabled><span class="glyphicon glyphicon-question-sign"></span>
</label>
<label class="btn disabled btn-default" ng-class="entry.attendState == 'yes' && 'btn-success'">
<input type=radio value=yes disabled><span class="glyphicon glyphicon-thumbs-up"></span>
</label>
</div>
</td>
<td nowrap class=align-middle ng-if="signedIn && ! entry.inPast">
<div ng-if="entry.attendState=='no'" class=btn-group bs-radio-group ng-model=entry.attendState>
<label class="btn btn-danger">
<input type=radio value=no><span class="glyphicon glyphicon-thumbs-down"></span>
</label>
<label class="btn btn-default" ng-click=addMaybe(entry.id) bs-tooltip="{title:'Maybe attending'}">
<input type=radio value=maybe><span class="glyphicon glyphicon-question-sign"></span>
</label>
<label class="btn btn-default" bs-tooltip="{title: ! entry.canAttend ? 'You are unable to attend based on your availability' : (! entry.canBeScheduled ? 'You are attending a different show at this time or don\'t have enough time to travel between venues' : 'Add to schedule')}" ng-click="entry.canBeScheduled && addToSchedule(entry.id)" ng-class="{disabled: !entry.canBeScheduled}">
<input type=radio value=yes ng-disabled=!entry.canBeScheduled><span class="glyphicon glyphicon-thumbs-up"></span>
</label>
</div>
<div ng-if="entry.attendState=='maybe'" class=btn-group bs-radio-group ng-model=entry.attendState>
<label class="btn btn-default" ng-click=removeFromSchedule(entry.id) bs-tooltip="{title: 'Not attending'}">
<input type=radio value=no><span class="glyphicon glyphicon-thumbs-down"></span>
</label>
<label class="btn btn-warning">
<input type=radio value=maybe><span class="glyphicon glyphicon-question-sign"></span>
</label>
<label class="btn btn-default" bs-tooltip="{title: ! entry.canAttend ? 'You are unable to attend based on your availability' : (! entry.canBeScheduled ? 'You are attending a different show at this time or don\'t have enough time to travel between venues' : 'Add to schedule')}" ng-class="{disabled: !entry.canBeScheduled}">
<input type=radio value=yes ng-disabled=!entry.canBeScheduled><span class="glyphicon glyphicon-thumbs-up"></span>
</label>
</div>
<div ng-if="entry.attendState=='yes'" class=btn-group bs-radio-group ng-model=entry.attendState>
<label class="btn btn-default" ng-click=removeFromSchedule(entry.id) bs-tooltip="{title: 'Remove from schedule'}">
<input type=radio value=no><span class="glyphicon glyphicon-thumbs-down"></span>
</label>
<label class="btn btn-default" ng-click=addMaybe(entry.id) bs-tooltip="{title:'Remove from schedule, maybe attending'}">
<input type=radio value=maybe><span class="glyphicon glyphicon-question-sign"></span>
</label>
<label class="btn btn-success">
<input type=radio value=yes><span class="glyphicon glyphicon-thumbs-up"></span>
</label>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="app/map/map.html">
<div class=jumbotron>
<div class=container>
<h1>Map</h1>
</div>
</div>
<div class=container>
<p class="lead text-center" ng-if="! mapLoaded">Loading map...</p>
<div class=row ng-if=markerGroups ng-style="{visibility: !mapLoaded ? 'hidden' : 'visible'}">
<div class=col-md-3>
<h3>Views</h3>
<ul class=list-unstyled>
<li ng-repeat="view in ::views"><a href ng-click=gotoView(view)>{{view.name}}</a></li>
</ul>
<hr>
<h3 style=margin-bottom:15px>Layers</h3>
<ul class="nav nav-default nav-pills nav-stacked">
<li ng-repeat="group in ::markerGroups" ng-class={active:isGroupVisible[group.id]}>
<a href ng-click=toggleGroup(group.id)>{{group.name}}</a>
</li>
</ul>
</div>
<div class=col-md-9>
<div>
<ng-map ng-style="{height: (innerHeight - 110) + 'px'}" clickable-icons=false fullscreen-control=false max-zoom=20 min-zoom=7 street-view-control=false tilt=0 map-type-control-options="{mapTypeIds: ['roadmap', 'hybrid']}">
<shape name=polygon paths={{lawnPolygon}} stroke-color=#94af72 stroke-opacity=1 stroke-weight=1 fill-color=#cbe6a3 fill-opacity=0.8>
</shape>
<marker position=current-position icon="{url:'img/map/current-location.png', scaledSize:[24, 24]}"></marker>
<div ng-repeat="group in ::markerGroups">
<marker ng-repeat="(markerId, marker) in ::group.markers" id="{{group.id + '-' + markerId}}" position={{::marker.position}} title={{::marker.title}} icon=img/map/{{marker.icon}}.png ng-if=isGroupVisible[group.id] on-click="markerClick(marker, group.id, markerId)"></marker>
</div>
<info-window id=marker-info>
<div ng-non-bindable>
<p class=lead>{{markerWindow.title}}</p>
<address ng-if="markerWindow.location || markerWindow.address">
<strong ng-if=markerWindow.location>{{markerWindow.location}}<br></strong>
<span ng-if=markerWindow.address>
{{markerWindow.address[0]}}<br>
{{markerWindow.address[1]}}
</span>
</address>
<p ng-if=markerWindow.notes>{{markerWindow.notes}}</p>
<p ng-if="markerWindow.venue || markerWindow.address">
<a class="btn btn-default btn-sm" ng-if=markerWindow.venue style=margin-right:6px href=/shows/venue/{{markerWindow.venue}}>Shows</a>
<a class="btn btn-default btn-sm" ng-if=markerWindow.address href="https://www.google.com/maps/dir/?api=1&destination={{markerWindow.location}}, {{markerWindow.address.join(', ')}}" target=_blank>Directions</a>
</p>
</div>
</info-window>
</ng-map>
</div>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="app/myFringe/myFringe.html">
<div class=jumbotron ng-class="{'has-tabs': $parent.signedIn}">
<div class=container>
<div class=row>
<div class=col-md-8>
<h1>My Fringe</h1>
</div>
<div class=col-md-4 bs-tooltip="{title: '(this is just our way of getting you to see more shows!)'}" style=margin-top:20px ng-show=isSignedIn>
<p class=lead style=margin-bottom:5px>Fringe Level: {{statuses[status].name}}</p>
<uib-progress max=maxLevel animate=false style=margin-bottom:2px>
<uib-bar value=level type=success></uib-bar>
<uib-bar value=nextLevelCount class=level-progress></uib-bar>
</uib-progress>
<small class=small ng-if=nextLevelRemaining>
Add <ng-pluralize count=nextLevelRemaining when=plurals.aShow></ng-pluralize> to your schedule to level up!
</small>
</div>
</div>
<div bs-active-pane=tabs.activeTab bs-tabs ng-if=$parent.signedIn>
<div data-title=Schedule name=Schedule bs-pane></div>
<div data-title=Availability name=Availability bs-pane></div>
<div data-title=Auto-Scheduler name=Auto-Scheduler bs-pane></div>
</div>
</div>
</div>
<div class=container ng-if=$parent.signedIn>
<my-fringe-schedule ng-if="tabs.activeTab == 'Schedule'"></my-fringe-schedule>
<my-fringe-availability ng-if="tabs.activeTab == 'Availability'"></my-fringe-availability>
<my-fringe-auto-scheduler ng-if="tabs.activeTab == 'Auto-Scheduler'"></my-fringe-auto-scheduler>
</div>
<div class=container ng-if="! $parent.signedIn">
<h1>You need to sign in to use My Fringe.</h1>
<br>
<p class=lead>My Fringe can automatically generate a personalized schedule.</p>
<br>
<p><a class="btn btn-primary btn-lg" href role=button ng-click=$parent.$parent.signIn()>Sounds awesome!</a></p>
</div>
</script>
<script type="text/ng-template" id="app/myFringe/schedule/schedule.html">
<div ng-if="! hasSchedule">
<div ng-if="! hasPreferences">
<h1>Not so fast!</h1>
<p class=lead>Before you can use this page, you need to select shows that you're interested in.</p>
<p>On the <a href=/shows>Shows</a> and <a href=/schedule>Schedule</a> screens you can assign an <strong>Interest</strong> to each show using the checkmark icons. They look like this:</p>
<br>
<div class=row>
<div ng-repeat="i in [0, 1, 2, 3, 4]" class="col-md-2 text-center" ng-class="$first && 'col-md-offset-1'">
<interest desire=i class=lead></interest><br>
{{interestText[i]}}
</div>
</div>
<br>
<p>Once you've done that, come back to this screen.</p>
</div>
<div ng-if=hasPreferences>
<h1>Your schedule is empty :(</h1>
<p class=lead>Now that you've selected some shows that you're interested in, it's time to build your schedule.</p>
<p>The best way to do that is to head over to the Auto-Scheduler.</p>
<br>
<p><a href=/my-fringe/auto-scheduler class="btn btn-primary btn-lg">Go to the Auto-Scheduler</a></p>
<br>
<p>Or, you can do this manually on the <a href=/schedule>Schedule</a> screen.</p>
</div>
</div>
<div class=row ng-if="hasSchedule && loaded">
<div class=col-md-3>
<div data-offset-top=-95 bs-affix>
<p class=text-center>
<button ng-click=openGoogleCalendarSyncSetup() class="btn btn-primary" ng-class="calendarSyncEnabled ? 'btn-primary' : 'btn-success'">{{calendarSyncEnabled ? 'Google Calendar Sync: On' : 'Turn On Google Calendar Sync'}}</button>
</p>
<br>
<month-day-picker days=days model=filter.currentDay></month-day-picker>
<p class=text-center>
<button class="btn btn-default btn-sm" ng-disabled="! filter.currentDay" ng-click="filter.currentDay = 0">Show Full Schedule</button>
</p>
<br>
<div class="alert alert-success">
<i class="glyphicon glyphicon-hand-right"></i> Don't forget to buy tickets!
</div>
</div>
</div>
<div class=col-md-9>
<table class="table table-striped amazing-schedule">
<tbody ng-repeat="(day, amazingScheduleDay) in amazingSchedule" ng-if="! filter.currentDay || filter.currentDay == day">
<tr class=header>
<th colspan=5>
<h3 class=bg-info>{{moment(day, 'X').format('dddd, MMM D')}}</h3>
</th>
</tr>
<tr>
<th>Time</th>
<th>Show</th>
<th>Venue</th>
</tr>
<tr ng-repeat="item in amazingScheduleDay" ng-class=item.as>
<td ng-if="item.as=='performance'" nowrap>{{moment(item.start, 'X').format('h:mm a')}}</td>
<td ng-if="item.as=='performance'"><a href=/show/{{shows[item.show].slug}}>{{shows[item.show].name}}</a></td>
<td ng-if="item.as=='performance'">
<span class="label label-venue-default label-venue-{{shows[item.show].venue}}">
{{venues[shows[item.show].venue].name}}
</span>

</td>
<td ng-if="item.as!=='performance'" colspan=5 ng-class=item.as>{{item.text}}</td>
</tr>
</tbody>
</table>
</div>
</div>

</script>
<script type="text/ng-template" id="app/myFringe/schedule/googleCalendarSyncSetupModal/googleCalendarSyncSetupModal.html">
<div class=modal-header>
<h3 class=modal-title>Google Calendar Sync</h3>
</div>
<div ng-show="! hasPermission">
<div class=modal-body>
<p>We can copy your schedule to your Google calendar and keep it updated automatically. You can use this to view your Fringe schedule on your phone and get reminders.</p>
<p>All you need to do to get started is give us access to your calendar.</p>
</div>
<div class=modal-footer>
<button class="btn btn-default" type=button ng-click=close()>Close</button>
<button class="btn btn-primary" type=button ng-click=requestPermission()>Continue</button>
</div>
</div>
<div ng-show="hasPermission && ! isSetup">
<div class=modal-body>
<p class=lead>Which calendar should we copy your schedule to?</p>
<div class=radio>
<label>
<input type=radio ng-model=setupConfig.target name=setupTarget value=primary>
Primary calendar (recommended)
</label>
</div>
<div class=radio>
<label>
<input type=radio ng-model=setupConfig.target name=setupTarget value=secondary>
Another calendar
</label>
</div>
<blockquote style=font-size:100% ng-show="setupConfig.target == 'secondary'">
<div class=radio>
<label style=width:100%>
<input type=radio ng-model=setupConfig.secondary name=secondaryCalendar value=NEW>
Create a new calendar:
<input ng-model=setupConfig.secondaryName class=form-control style="margin:5px 0" placeholder="New calendar name">
</label>
</div>
<div ng-show=secondaryCalendars.length>
<p>or select an existing calendar:</p>
<div class=radio ng-repeat="calendar in secondaryCalendars">
<label>
<input type=radio ng-model=setupConfig.secondary name=secondaryCalendar value={{calendar.id}}>
{{calendar.name}}
</label>
</div>
</div>
</blockquote>
</div>
<div class=modal-footer>
<button class="btn btn-default" type=button ng-click=close() ng-disabled=working>Close</button>
<button class="btn btn-primary" type=button ng-click=setup() ng-disabled="setupConfig.secondary=='NEW' && ! setupConfig.secondaryName.length">Continue</button>
</div>
</div>
<div ng-show="isSetup && isSyncing">
<div class=modal-body ng-show="! max">
<p class=lead>Setting up calendar...</p>
<div class=progress>
<div class="progress-bar progress-bar-striped active" style=width:100%></div>
</div>
</div>
<div class=modal-body ng-show=max>
<p class=lead>Copying schedule for the first time...</p>
<uib-progressbar max=max value=progress animate=true type=primary></uib-progressbar>
</div>
</div>
<div ng-show="isSetup && ! isSyncing && turnOffScreen">
<div class=modal-body>
<p class=lead>Turn Google Calendar Sync off?</p>
<p>If you turn Google Calendar Sync off:</p>
<ul>
<li>your Google calendar will not be updated automatically</li>
<li>shows previously synced to your calendar will not be removed</li>
<li>you can turn it back on again later</li>
</ul>
<br>
<p class=text-center>
<button ng-click="turnOffScreen = false" class="btn btn-success btn-lg">Keep it on</button><br>
<button ng-click="turnOff(); turnOffScreen = false" class="btn btn-danger" style=margin-top:10px>Turn it off</button>
</p>
</div>
</div>
<div ng-show="isSetup && ! isSyncing && ! turnOffScreen">
<div class=modal-body>
<p class=lead>Google Calendar Sync is turned on.</p>
<p>Any time you add or remove a show from your schedule, your Google calendar will be updated automatically.</p>
<br>
<p class=text-center>
<a href={{calendarUrl}} target=_blank class="btn btn-primary btn-lg">Open Google Calendar</a>
</p>
<br>
<p>If you have an Android device, you can see your calendar in the Google Calendar app. It may take a few moments for changes to appear.</p>
<br>
<p><strong>Useful links:</strong></p>
<ul>
<li><a href="https://support.google.com/calendar/answer/151674?co=GENIE.Platform%3DAndroid&hl=en&oco=0" target=_blank>Sync Calendar with iPhone or iPad</a></li>
<li><a href=https://support.google.com/calendar/answer/99358 target=_blank>See Google Calendar events on Apple Calendar</a></li>
<li><a href="https://support.google.com/calendar/answer/37648?hl=en&ref_topic=3417927" target=_blank>Sync your calendar with computer programs</a></li>
</ul>
</div>
<div class=modal-footer>
<button class="btn btn-default pull-left" type=button ng-click="turnOffScreen = true">Turn Off</button>
<button class="btn btn-primary" type=button ng-click=close()>Close</button>
</div>
</div>
</script>
<script type="text/ng-template" id="app/myFringe/availability/availability.html">
<div ng-if=availabilitySlots>
<div class=row>
<div class=col-md-6>
<p>Select the time slots you are available by clicking them. Each slot is an hour.</p>
<p class=hidden-xs>You can click and drag to select multiple slots at once.</p>
</div>
<div class="col-md-6 availability-legend text-right">
<strong>Legend:</strong>
&nbsp;
<span class="availability-block bg-info" bs-tooltip="{title:'You have a show scheduled during this slot.'}">Scheduled</span>
<span class="availability-block bg-success">Available</span>
<span class="availability-block unavailable">Unavailable</span>
</div>
</div>
<div style=overflow-x:auto;max-width:100vw>
<table class=availability-buffer style=overflow-x:scroll>
<tr>
<td colspan=3 ng-mouseover=dragStop()></td>
</tr>
<tr>
<td ng-mouseover=dragStop()></td>
<td>
<table class="table table-bordered table-condensed table-bordered availability" ng-mouseup=dragStop() draggable=false>
<thead>
<tr ng-mouseover=dragStop()>
<th class=text-center ng-mouseover=dragStop() ng-repeat="(dayId, x) in ::availabilitySlots" ng-init="dow = moment(dayId, 'X').format('ddd')" ng-class="{'weekend': dow == 'Sat' || dow == 'Sun'}">
{{::dow}}<br>
<span class=lead>{{::moment(dayId, 'X').format('D')}}</span><br>
{{::moment(dayId, 'X').format('MMM')}}
</th>
</tr>
</thead>
<tbody>
<tr ng-repeat="timeId in ::availabilitySlotsAll">
<td nowrap ng-repeat="(dayId, daySlots) in ::availabilitySlots" ng-init="start = +dayId + timeId; stop = start + slotSize; empty = daySlots.indexOf(start) == -1; dow = moment(dayId, 'X').format('ddd')" ng-class="::{empty: empty, weekend: dow == 'Sat' || dow == 'Sun'}" ng-mousedown="slotPerformances[start].length ? showPerformances(start, stop, slotPerformances[start]) : dragStart(start)" ng-mouseover="! slotPerformances[start].length && start > 0 && dragOver(start)">
<div class=availability-block ng-class="!empty && (slotPerformances[start].length ? 'bg-info' : (availability[start] ? 'bg-success' : 'unavailable'))" ng-if=::!empty bs-tooltip="!dragging && {title:slotPerformances[start].length ? 'Click to see performances' : moment(start, 'X').format('h:mm a') + ' - ' + moment(stop, 'X').format('h:mm a')}">
{{::moment(start, 'X').format('h a')}}
</div>
</td>
</tr>
</tbody>
</table>
</td>
<td ng-mouseover=dragStop()></td>
</tr>
<tr>
<td colspan=3 ng-mouseover=dragStop()></td>
</tr>
</table>
</div>
</div>
</script>
<script type="text/ng-template" id="app/myFringe/availability/slotPerformancesModal/slotPerformancesModal.html">
<div class=modal-header>
<h3 class=modal-title>
{{moment(slotStart, 'X').format('ddd, MMM Do hh:mma')}} - {{moment(slotStop, 'X').format('hh:mma')}}
</h3>
</div>
<div class=modal-body>
<table class=table>
<thead>
<tr>
<th>Time</th>
<th>Show</th>
<th>Venue</th>
<th></th>
</tr>
</thead>
<tbody>
<tr ng-repeat="performanceId in slotPerformances" ng-init="performance = performances[performanceId]">
<td nowrap>{{moment(performance.start, 'X').format('h:mm a')}} - {{moment(performance.stop, 'X').format('h:mm a')}}</td>
<td><strong><a href=/show/{{shows[performance.show].slug}}>{{shows[performance.show].name}}</a></strong></td>
<td>
<span class="label label-venue-default label-venue-{{shows[performance.show].venue}}">
{{venues[shows[performance.show].venue].name}}
</span>
</td>
<td>
<button class="btn btn-xs btn-danger" ng-click=remove(performanceId) bs-tooltip="{title: 'Remove'}">
<span class="glyphicon glyphicon-remove"></span>
</button>
</td>
</tr>
</tbody>
</table>
</div>
<div class=modal-footer>
<button class="btn btn-primary" type=button ng-click=ok()>OK</button>
</div>
</script>
<script type="text/ng-template" id="app/myFringe/autoScheduler/autoScheduler.html">
<div ng-if=!screen>
<h1>Analyzing...</h1>
<div class=progress>
<div class="progress-bar progress-bar-striped active" style=width:100%>
</div>
</div>
</div>
<div ng-if=screen>
<div ng-if="screen == 'intro'">
<h1>Introduction</h1>
<p class=lead>The Auto-Scheduler helps build your schedule automatically. It needs to know two things:</p>
<blockquote>
<h3 style=margin-top:0>1. What shows do you want to see?</h3>
<p>On the <a href=/shows>Shows</a> and <a href=/schedule>Schedule</a> screens you can assign an <strong>Interest</strong> to each show using the checkmark icons. They look like this:</p>
<br>
<div class=row>
<div ng-repeat="i in [0, 1, 2, 3, 4]" class="col-md-2 text-center" ng-class="$first && 'col-md-offset-1'">
<interest desire=i class=lead></interest><br>
{{interestText[i]}}
</div>
</div>
<br>
<p>When the Auto-Scheduler runs, it will fill your schedule with higher interest shows first.</p>
<br>
<h3>2. When are you available?</h3>
<p>On the <a href=/my-fringe/availability>My Availability</a> tab, you can select which times you are available to see shows.</p>
<p>When the Auto-Scheduler runs, it won't schedule shows for times you aren't available.</p>
</blockquote>
<br>
<div class=text-center>
<button class="btn btn-lg btn-primary" ng-click=completeIntro()>Got it!</button>
</div>
</div>
<div ng-if="screen == 'no-interests'">
<h1>Not so fast!</h1>
<p class=lead>Before you can use this page, you need to select shows that you're interested in.</p>
<p>On the <a href=/shows>Shows</a> and <a href=/schedule>Schedule</a> screens you can assign an <strong>Interest</strong> to each show using the checkmark icons. They look like this:</p>
<br>
<div class=row>
<div ng-repeat="i in [0, 1, 2, 3, 4]" class="col-md-2 text-center" ng-class="$first && 'col-md-offset-1'">
<interest desire=i class=lead></interest><br>
{{interestText[i]}}
</div>
</div>
<br>
<p>When the Auto-Scheduler runs, it will fill your schedule with higher interest shows first.</p>
<p>Once you've done that, come back to this screen.</p>
</div>
<div class=row ng-if="screen != 'intro' && screen != 'no-interests'">
<div class=col-md-9>
<div ng-if="screen == 'schedule-full'">
<h1>Your schedule is full!</h1>
<br>
<p>It's not possible to add any more shows to your schedule.</p>
<p ng-if=allDesiredShowsOnSchedule>But, all of the shows you're interested in are on your schedule.</p>
</div>
<div ng-if="screen == 'schedule-complete'">
<h1>Good news!</h1>
<br>
<p>Every show you want to see is on your schedule.</p>
<p>But, there's still room on your schedule for other shows.</p>
</div>
<div ng-if="screen == 'no-possible-desired'">
<h1>There's bad news and there's good news</h1>
<br>
<p><strong>Bad news:</strong> there's no room on your schedule for any more of the shows you're interested in.</p>
<p><strong>Good news:</strong> there's still room on your schedule for other shows.</p>
</div>
<div ng-if="screen == 'instant-add'">
<h1>I found
<ng-pluralize count=instantAddPerformances.length when="instantAddScreenCount == 1 ? plurals.showSome : plurals.showSomeMore"></ng-pluralize>
you can see!</h1>
<br>
<p>These shows can be added to your schedule without impacting your ability to see other shows.</p>
<br>
<table class="table table-striped">
<thead>
<tr>
<th>Date/Time</th>
<th>Show</th>
<th>Interest</th>
</tr>
</thead>
<tbody>
<tr ng-repeat="entry in instantAddPerformances">
<td nowrap>
<strong>{{::moment(entry.performance.start, 'X').format('dddd, MMMM D')}}</strong><br>
{{::moment(entry.performance.start, 'X').format('h:mm a')}} - {{::moment(entry.performance.stop, 'X').format('h:mm a')}}
</td>
<td>
<p class=h4 style="margin:0 0 10px"><a href=/show/{{::entry.show.slug}}>{{::entry.show.name}}</a></p>
<span class="label label-venue-default label-venue-{{::entry.venueId}}">{{::entry.venue.name}}</span>
<show-rating value=::entry.show.rating></show-rating>
<span class="label label-success">{{entry.show.price|price}}</span>
</td>
<td nowrap class=align-middle><interest show-id=entry.showId></interest></td>
</tr>
</tbody>
</table>
<br>
<p><button class="btn btn-primary" ng-click=addInstantAdd()>Add Shows &amp; Continue</button></p>
</div>
<div ng-if="screen == 'generator'">
<h1>It's time to generate!</h1>
<br>
<div class="alert alert-warning">
<i class="glyphicon glyphicon-exclamation-sign"></i>
Don't use this until you have assigned an Interest to each show you're interested in.
</div>
<p>When you click <strong>Generate Schedule</strong>, I will:</p>
<ul>
<li>try to fit in as many shows that you're interested in as possible</li>
<li>ensure you have enough time to get to every show</li>
<li>prefer to place shows in nearby venues to reduce travel between locations</li>
<li ng-if="showsOnScheduleCount > 0">
not touch the <ng-pluralize count=showsOnScheduleCount when=plurals.show></ng-pluralize> already on your schedule
</li>
</ul>
<br>
<p>You'll have an opportunity to review the schedule before it is saved.</p>
<br>
<p><button class="btn btn-primary" ng-click=generate()>Generate Schedule</button></p>
</div>
<div ng-if="screen == 'done'">
<h1>Done!</h1>
<br>
<p>I've done all I can do for now. Have a look at your schedule to double-check that you're happy with it.</p>
<br>
<br>
<p><a href=/my-fringe class="btn btn-primary">View Schedule</a></p>
</div>
</div>
<div class=col-md-3 style=padding-top:25px>
<div class="panel panel-default" data-offset-top=-80 bs-affix>
<div class=panel-heading>
<h3 class=panel-title>Schedule Progress</h3>
</div>
<div class=panel-body>
<div>
<strong>Fullness</strong>
<uib-progressbar class=progress max=availablePerformanceCount value="availablePerformanceCount - possiblePerformanceCount" animate=true type=primary></uib-progressbar>
</div>
<hr>
<div ng-repeat="desire in [4, '3', '2', '1']">
<small>
<interest desire=desire></interest>
<em class=pull-right>{{progressByDesire[desire]}}/{{progressByDesireMax[desire]}}</em>
</small>
<uib-progressbar class=progress ng-style="$last && {marginBottom: 0}" max=progressByDesireMax[desire] value=progressByDesire[desire] animate=true type="{{getProgressType(progressByDesire[desire], progressByDesireMax[desire])}}"></uib-progressbar>
</div>
</div>
</div>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="app/myFringe/autoScheduler/autoSchedulerModal/autoSchedulerModal.html">
<div ng-if="! proposed">
<div class=modal-header>
<h3 class=modal-title>Generating Schedule...</h3>
</div>
<div class=modal-body>
<p>
<small>
<strong>Progress</strong>
<em class=pull-right>
{{currentGeneration && 'up to ' + moment.duration(timeRemaining).humanize() + ' remaining' || 'calculating...'}}
</em>
</small>
<uib-progressbar class="progress-striped active" max=100 value=progress animate=true type=primary></uib-progressbar>
</p>
<div class=row>
<div class=col-md-3 ng-repeat="desire in ['4', '3', '2', '1']">
<small>
<interest desire=desire></interest>
<em ng-if=userData.settings.displaySchedulerStats>({{desireFitnessPoints[desire]}} points)</em>
<em class=pull-right>{{progressByDesire[desire]}}/{{progressByDesireMax[desire]}}</em>
</small>
<uib-progressbar class=progress max=progressByDesireMax[desire] value=progressByDesire[desire] animate=true type="{{getProgressType(progressByDesire[desire], progressByDesireMax[desire])}}">
</uib-progressbar>
</div>
</div>
<div class=small ng-if=userData.settings.displaySchedulerStats>
<div class=row>
<div class=col-md-3>
<strong>Generation</strong><br>
{{currentGeneration | number}}/{{generationCount | number}}
</div>
<div class=col-md-3><strong>Schedules Tested</strong><br>
{{currentGeneration * populationSize | number}}/{{populationSize * generationCount | number}}
</div>
<div class=col-md-3>
<strong>Current Best</strong><br>
{{bestFitness - bestExtraPoints | number}}/{{idealFitness | number}} (+{{bestExtraPoints}} xp = {{bestFitness | number}})
</div>
<div class=col-md-3>
<strong>Current Worst</strong><br>
{{worstFitness | number}}
</div>
</div>
<br>
<br>
<p>This tool uses a custom <a href=https://en.wikipedia.org/wiki/Genetic_algorithm>genetic algorithm</a> running in a WebWorker to find a schedule.<br>
The population size ({{populationSize|number}}) and number of generations ({{generationCount|number}}) is proportional to the number of shows that need placed.</p>
<p>The crossover rate is {{crossoverRate}} and uses a two-point crossover with parents chosen by rank selection.<br>
The mutation rate is {{mutationRate}} and makes 1 or 2 random changes to a schedule.</p>
<p>Each schedule is scored giving points for every show in the schedule. Higher interest shows get more points.<br>
Extra points (xp) are awarded when adjacent shows are in nearby venues.</p>
</div>
<br>
<p class="alert alert-info" style=margin-bottom:0><i class="glyphicon glyphicon-info-sign"></i>{{infoMessages[currentMessage]}}</p>
</div>
<div class=modal-footer>
<button bs-checkbox class="btn pull-left btn-default" bs-tooltip="{title: 'Stats for nerds'}" data-placement=right ng-model=userData.settings.displaySchedulerStats>
<i class="glyphicon glyphicon-dashboard"></i>
</button>
<button class="btn btn-default" type=button ng-click=restart() ng-disabled="progress === 0 || done">Restart</button>
<button class="btn btn-danger" type=button ng-click=stop() ng-disabled="progress === 0 || done">Stop</button>
</div>
</div>
<div ng-if=proposed ng-init="tabs={activeTab:0}">
<div class=modal-header style=border:0;padding-bottom:0>
<h3 class=modal-title>Review Schedule</h3>
<div class=row style=margin-top:15px>
<div class=col-md-3 ng-repeat="desire in ['4', '3', '2', '1']">
<small>
<interest desire=desire></interest>
<em ng-if="userData.settings.displaySchedulerStats && !proposed">({{desireFitnessPoints[desire]}} points)</em>
<em class=pull-right>{{progressByDesire[desire]}}/{{progressByDesireMax[desire]}}</em>
</small>
<uib-progressbar class=progress max=progressByDesireMax[desire] value=progressByDesire[desire] type="{{getProgressType(progressByDesire[desire], progressByDesireMax[desire])}}">
</uib-progressbar>
</div>
</div>
<div bs-active-pane=tabs.activeTab bs-tabs ng-if="unscheduled.length > 0">
<div data-title="Proposed Schedule" bs-pane></div>
<div data-title="Unscheduled Shows" bs-pane></div>
<div data-title="More Information" bs-pane></div>
</div>
</div>
<div class=modal-body inner-height=innerHeight ng-style="{maxHeight: (innerHeight-295) + 'px'}" style=overflow-y:scroll>
<div ng-show="tabs.activeTab == 0">
<div class="alert alert-success" ng-if=!unscheduled.length>
<strong>Success!</strong>
Every show you want to see is on the schedule.
</div>
<div class="alert alert-warning" ng-if=unscheduled.length>
<strong>Oh no!</strong>
I wasn't able to fit all of the shows you want to see on the schedule.
<a href ng-click="tabs.activeTab=1">Which ones?</a>
<a href ng-click="tabs.activeTab=2">Why?</a>
</div>
<table class=table style=margin-bottom:0>
<thead>
<tr>
<th>Date/Time</th>
<th>Show/Venue</th>
<th>Interest</th>
<th>Accept?</th>
</tr>
</thead>
<tbody>
<tr ng-repeat="pId in sortedPerformances" ng-if="proposed.indexOf(pId) > -1 || isUserAttendingPerformance(pId)" ng-init="performance = performances[pId]">
<td nowrap><strong>{{moment(performance.start, 'X').format('ddd, MMM Do')}}</strong><br>
{{moment(performance.start, 'X').format('h:mm a')}} - {{moment(performance.stop, 'X').format('h:mm a')}}</td>
<td><strong>{{shows[performance.show].name}}</strong><br>
<span class="label label-venue-default label-venue-{{shows[performance.show].venue}}">
{{venues[shows[performance.show].venue].name}}
</span>
</td>
<td nowrap style=vertical-align:middle>
<interest desire=userData.preferences[performance.show]></interest>
</td>
<td ng-if=isUserAttendingPerformance(pId) class=align-middle nowrap bs-tooltip="{title:'Already on your schedule.'}">
<button class="btn disabled">
<span class="glyphicon glyphicon-thumbs-down"></span>
</button>
<button class="btn btn-success disabled">
<span class="glyphicon glyphicon-thumbs-up"></span>
</button>
</td>
<td nowrap ng-if="! isUserAttendingPerformance(pId)" class=align-middle>
<button class=btn ng-class="{'btn-danger': !accept[pId]}" ng-click="accept[pId]=false">
<span class="glyphicon glyphicon-thumbs-down"></span>
</button>
<button class=btn ng-class="{'btn-success': accept[pId]}" ng-click="accept[pId]=true">
<span class="glyphicon glyphicon-thumbs-up"></span>
</button>
</td>
</tr>
</tbody>
</table>
</div>
<div ng-show="tabs.activeTab == 1">
<p class=lead>{{unscheduled.length > 1 ? 'These are the shows' : 'This is the show'}} I couldn't fit on the schedule.</p>
<p>Want <a href ng-click="tabs.activeTab=2">more information</a>?</p>
<table class=table style=margin-bottom:0>
<thead>
<tr>
<th>Show</th>
<th>Desire</th>
</tr>
</thead>
<tbody>
<tr ng-repeat="showId in unscheduled">
<td>{{shows[showId].name}}</td>
<td>
<interest desire=userData.preferences[showId]></interest>
</td>
</tr>
</tbody>
</table>
</div>
<div ng-show="tabs.activeTab == 2">
<p class=lead>So, why can't you find a schedule where I can see every show?</p>
<ol>
<li>Such a schedule may not be possible.</li>
<li>This is actually a very difficult thing for computers to do.</li>
</ol>
<hr>
<p class=lead>What can I do?</p>
<p>You have a few options:</p>
<ol>
<li>You can click <strong>Try Again</strong>.
<ul class=small>
<li>PRO: You may get a better schedule with more shows.</li>
<li>CON: You may get a worse schedule.</li>
</ul>
<br>
</li>
<li>You can hand-pick some show times that you like, reject the rest, and run the generator again.
<ul class=small>
<li>PRO: The size of the problem is reduced making it easier to solve.</li>
<li>CON: You're locked-in to the show times you hand-pick and consequences of that.</li>
</ul>
<br>
</li>
<li>You can accept the schedule.
<ul class=small>
<li>PRO: You have a schedule!</li>
<li>CON: [some annoying life lesson about not always getting what you want]</li>
</ul>
</li>
</ol>
<hr>
<p class=lead>Why is this such a hard problem for computers? [Nerd alert!]</p>
<p>Let's do a simple example, and we'll assume the following:</p>
<ol>
<li>Each show has 6 show times.</li>
<li>You're available to see any show at any time.</li>
<li>We take Interest level and travel time between venues out of the equation.</li>
</ol>
<br>
<p>With that information, we can calculate the number of possible schedules depending on how many shows you want to see:</p>
<div class=row>
<div class=col-md-{{section.w}} ng-repeat="section in examplePowers">
<table class="table table-condensed table-striped">
<thead>
<tr>
<th>Shows</th>
<th>Possible Schedules</th>
</tr>
</thead>
<tbody>
<tr ng-repeat="power in section.p" bs-tooltip="power.i == 25 && {title:'Weird how that\'s the only one that doesn\'t end with a 6!'}">
<th>{{power.i}}</th>
<td>{{power.p}}</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>So, it quickly becomes impractical to look at every possible schedule. This is the type of problem that would be <em>perfect</em> for a <a href=https://en.wikipedia.org/wiki/Quantum_computing target=_blank>Quantum Computer</a>.</p>
<p>The Auto-Scheduler uses a custom <a href=https://en.wikipedia.org/wiki/Genetic_algorithm>Genetic Algorithm</a>. Instead of looking for the best possible schedule, it looks for a really great schedule. If there is a possible combination of show times that would allow you to see every show you want, the algorithm will almost certainly never find it...but it <em>will</em> find something that's really <em>close</em> to an ideal schedule. The longer it runs, the closer it can get.</p>
</div>
</div>
<div class=modal-footer>
<button class="btn btn-primary pull-left" type=button ng-click=start()>Try Again</button>
<button class="btn btn-success" type=button ng-click=save()>Save Schedule</button>
<button class="btn btn-danger" type=button ng-click=close()>Discard Schedule</button>
</div>
</div>

</script>
<script type="text/ng-template" id="app/core/help/help.html">
<div class=aside tabindex=-1 role=dialog>
<div class=aside-dialog>
<div class=aside-content>
<div class=aside-header>
<button type=button class=close ng-click=$hide()>&times;</button>
<h4 class=aside-title>Help</h4>
</div>
<div class=aside-body>
<h2>{{title}}</h2>
<p>THIS IS THE BODY</p>
</div>
<div class=aside-footer>
<button type=button class="btn btn-default" ng-click=$hide()>Close</button>
</div>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="app/core/loginModal/loginModal.html">
<div class=modal-header>
<h3 class=modal-title>{{signingIn ? 'Loading your information...' : 'Sign In'}}</h3>
</div>
<div class=modal-body ng-show="! signingIn">
<p>All you need is a Google account. Just connect and go!</p>
<br>
<div id=google-sign-in-button></div>
<br>
</div>
<div class=modal-body ng-show=signingIn>
<br>
<div class=progress>
<div class="progress-bar progress-bar-striped active" style=width:100%></div>
</div>
</div>
<div class=modal-footer>
<button class="btn btn-primary" type=button ng-click=close() ng-disabled=signingIn>Close</button>
</div>
</script>
